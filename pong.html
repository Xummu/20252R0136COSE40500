<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>클래식 핑퐁 게임</title>
    <style>
        body { margin: 0; background: #222; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; color: white; font-family: 'Courier New', Courier, monospace; }
        canvas { background: #000; border: 5px solid #fff; box-shadow: 0 0 20px rgba(255,255,255,0.2); }
        #instructions { position: absolute; bottom: 20px; color: #888; }
    </style>
</head>
<body>

    <canvas id="pong"></canvas>
    <div id="instructions">마우스를 움직여 오른쪽 패들을 조종하세요</div>

<script>
    const canvas = document.getElementById("pong");
    const ctx = canvas.getContext("2d");

    canvas.width = 600;
    canvas.height = 400;

    // 게임 객체 정의
    const ball = {
        x: canvas.width / 2,
        y: canvas.height / 2,
        radius: 10,
        speed: 5,
        dx: 5,
        dy: 5,
        color: "#fff"
    };

    const user = {
        x: canvas.width - 20,
        y: canvas.height / 2 - 50,
        width: 10,
        height: 100,
        score: 0,
        color: "#fff"
    };

    const com = {
        x: 10,
        y: canvas.height / 2 - 50,
        width: 10,
        height: 100,
        score: 0,
        color: "#fff"
    };

    // 마우스 이동 감지
    canvas.addEventListener("mousemove", (e) => {
        let rect = canvas.getBoundingClientRect();
        user.y = e.clientY - rect.top - user.height / 2;
    });

    // 사각형 그리기 함수
    function drawRect(x, y, w, h, color) {
        ctx.fillStyle = color;
        ctx.fillRect(x, y, w, h);
    }

    // 원 그리기 함수
    function drawBall(x, y, r, color) {
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.arc(x, y, r, 0, Math.PI * 2, false);
        ctx.closePath();
        ctx.fill();
    }

    // 점수 그리기
    function drawScore(text, x, y) {
        ctx.fillStyle = "#fff";
        ctx.font = "45px Arial";
        ctx.fillText(text, x, y);
    }

    // 충돌 체크 함수
    function collision(b, p) {
        p.top = p.y;
        p.bottom = p.y + p.height;
        p.left = p.x;
        p.right = p.x + p.width;

        b.top = b.y - b.radius;
        b.bottom = b.y + b.radius;
        b.left = b.x - b.radius;
        b.right = b.x + b.radius;

        return b.right > p.left && b.bottom > p.top && b.left < p.right && b.top < p.bottom;
    }

    // 게임 업데이트
    function update() {
        // 공 이동
        ball.x += ball.dx;
        ball.y += ball.dy;

        // 천장과 바닥 반사
        if (ball.y + ball.radius > canvas.height || ball.y - ball.radius < 0) {
            ball.dy = -ball.dy;
        }

        // AI(컴퓨터) 패들 로직 (부드럽게 공을 따라감)
        let computerLevel = 0.1; 
        com.y += (ball.y - (com.y + com.height / 2)) * computerLevel;

        // 어느 쪽 패들에 부딪혔는지 확인
        let player = (ball.x + ball.radius < canvas.width / 2) ? com : user;

        if (collision(ball, player)) {
            // 공의 속도 반전 및 가속
            ball.dx = -ball.dx;
            ball.speed += 0.2; // 칠 때마다 빨라짐
        }

        // 득점 체크
        if (ball.x - ball.radius < 0) {
            user.score++;
            resetBall();
        } else if (ball.x + ball.radius > canvas.width) {
            com.score++;
            resetBall();
        }
    }

    function resetBall() {
        ball.x = canvas.width / 2;
        ball.y = canvas.height / 2;
        ball.speed = 5;
        ball.dx = -ball.dx; // 실점한 쪽 반대 방향으로 공 발사
    }

    // 렌더링
    function render() {
        // 배경 지우기
        drawRect(0, 0, canvas.width, canvas.height, "#000");

        // 중앙선 그리기
        for (let i = 0; i <= canvas.height; i += 20) {
            drawRect(canvas.width / 2 - 1, i, 2, 10, "#fff");
        }

        // 점수판
        drawScore(com.score, canvas.width / 4, canvas.height / 5);
        drawScore(user.score, 3 * canvas.width / 4, canvas.height / 5);

        // 패들과 공 그리기
        drawRect(com.x, com.y, com.width, com.height, com.color);
        drawRect(user.x, user.y, user.width, user.height, user.color);
        drawBall(ball.x, ball.y, ball.radius, ball.color);
    }

    function game() {
        update();
        render();
    }

    const framePerSecond = 50;
    setInterval(game, 1000 / framePerSecond);
</script>
</body>
</html>